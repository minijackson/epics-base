name: "Meson build"
description: "Does a full build, test and installation"
inputs:
  path:
    required: true
    type: string
  cross_file:
    required: false
    type: string

runs:
  using: composite
  steps:
    - name: Prepare Build
      run: meson ${{ inputs.cross_file && format('--cross_file {0}', inputs.cross_file) }} build ${{ inputs.path }}
      shell: bash
    - name: Run Build
      run: ninja -C build
      shell: bash
    - name: Run Test Suite
      run: meson test -C build
      shell: bash
    - name: Run Test Suite
      run: sudo meson install -C build
      shell: bash
    - name: Clean up build directory
      run: rm -rf build
      shell: bash
